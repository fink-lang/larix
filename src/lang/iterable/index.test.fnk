{describe, it, eq, snapshot} = import '../../testing/jest'

{parse_expr} = import '../../'


describe:: 'fold item, accu: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      fold item, accu=0:
        item + accu
    `) eq snapshot


describe:: 'unfold item, accu: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      unfold curr=start, accu=0:
        (start + accu, accu + 1)
    `) eq snapshot


  it:: 'parses no accu', fn:
    parse_expr(`
      unfold curr=start:
        start + accu
    `) eq snapshot


  it:: 'parses no args', fn:
    parse_expr(`
      unfold:
        foo
    `) eq snapshot


describe:: 'map item: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      map item:
        item * 2
    `) eq snapshot


describe:: 'flat_map item: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      flat_map item:
        [item, item * 2]
    `) eq snapshot


describe:: 'filter item: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      filter item:
        item % 2 == 0
    `) eq snapshot


describe:: 'while item: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      while item:
        item % 2 == 0
    `) eq snapshot


describe:: 'find item: ...', fn:

  it:: 'parses', fn:
    parse_expr(`
      find item:
        item % 2 == 0
    `) eq snapshot

