{describe, it, expect, to_match_snapshot, to_throw} = import '../../testing/jest'

{parse, parse_expr} = import '../../'


describe:: 'module', fn:

  it:: 'parses module', fn:
    expect::
      parse(`
        # leading module comment

        # expr comment
        foo = bar
        spam = ni

        # trailing module comment
      `)
      to_match_snapshot


describe:: 'module parse errors', fn:

  it:: 'throws with bad indentation', fn:
    expect::
      fn: parse(`
        match fooobar:
          match spam:
          shrub`,
        'test.fnk'
      )

      to_throw:: `
        test.fnk:3:2
        1| match fooobar:
        2|   match spam:
        3|   shrub
             ^

        Expected indentation > 2.
        `
